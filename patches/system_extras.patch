From 0a3813ba7c8168cfcd3794a82339caefe5dba183 Mon Sep 17 00:00:00 2001
From: SferaDev <sferadev@gmail.com>
Date: Mon, 28 Oct 2013 16:52:34 +0100
Subject: [PATCH 1/4] system_extras: Add make_ext4fs utility

Add make_ext4fs into $OUT/Utilities needed for some devices like Galaxy S I9000

Change-Id: Id9c9ce79282859542a1e44501b19594145d80275
---
 ext4_utils/Android.mk | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)

diff --git a/ext4_utils/Android.mk b/ext4_utils/Android.mk
index 0d9ea67..03f64bd 100644
--- a/ext4_utils/Android.mk
+++ b/ext4_utils/Android.mk
@@ -49,6 +49,25 @@ endif
 include $(BUILD_HOST_EXECUTABLE)
 
 
+include $(CLEAR_VARS)
+LOCAL_SRC_FILES := make_ext4fs_main.c
+LOCAL_MODULE := utility_make_ext4fs
+LOCAL_MODULE_STEM := make_ext4fs
+LOCAL_MODULE_TAGS := optional
+LOCAL_FORCE_STATIC_EXECUTABLE := true
+LOCAL_MODULE_CLASS := UTILITY_EXECUTABLES
+LOCAL_MODULE_PATH := $(PRODUCT_OUT)/utilities
+LOCAL_UNSTRIPPED_PATH := $(PRODUCT_OUT)/symbols/utilities
+LOCAL_STATIC_LIBRARIES += \
+    libext4_utils_static \
+    libselinux \
+    libsparse_static \
+    libz \
+    libcutils \
+    libc
+
+include $(BUILD_EXECUTABLE)
+
 #
 # -- All host/targets excluding windows
 #
-- 
2.7.4


From ad3fee0a929a0a9da931902ba2a9079bc54a53fa Mon Sep 17 00:00:00 2001
From: sooti <sooti85@gmail.com>
Date: Thu, 12 Nov 2015 16:42:52 +0100
Subject: [PATCH 2/4] fix ext4_utils build error

Change-Id: I5d80061f82653de41f91a8b18333afd06b9bfac0
---
 ext4_utils/Android.mk | 1 +
 1 file changed, 1 insertion(+)

diff --git a/ext4_utils/Android.mk b/ext4_utils/Android.mk
index 03f64bd..314b514 100644
--- a/ext4_utils/Android.mk
+++ b/ext4_utils/Android.mk
@@ -50,6 +50,7 @@ include $(BUILD_HOST_EXECUTABLE)
 
 
 include $(CLEAR_VARS)
+LOCAL_PACK_MODULE_RELOCATIONS := false
 LOCAL_SRC_FILES := make_ext4fs_main.c
 LOCAL_MODULE := utility_make_ext4fs
 LOCAL_MODULE_STEM := make_ext4fs
-- 
2.7.4


From d7027c62862dd35d33cb500b5f4935ca4bf542ec Mon Sep 17 00:00:00 2001
From: sooti <sooti85@gmail.com>
Date: Sat, 7 Nov 2015 19:45:31 +0100
Subject: [PATCH 3/4] ext4_utils: do not pack relocations for executables

Change-Id: I9c479eabab421b0829cdc3ab5d784305dcd14259

Conflicts:
	ext4_utils/Android.mk
---
 ext4_utils/Android.mk | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/ext4_utils/Android.mk b/ext4_utils/Android.mk
index 314b514..0263f99 100644
--- a/ext4_utils/Android.mk
+++ b/ext4_utils/Android.mk
@@ -1,4 +1,4 @@
-# Copyright 2010 The Android Open Source Project
+\# Copyright 2010 The Android Open Source Project
 
 LOCAL_PATH:= $(call my-dir)
 
@@ -51,7 +51,7 @@ include $(BUILD_HOST_EXECUTABLE)
 
 include $(CLEAR_VARS)
 LOCAL_PACK_MODULE_RELOCATIONS := false
-LOCAL_SRC_FILES := make_ext4fs_main.c
+LOCAL_SRC_FILES := make_ext4fs_main.c canned_fs_config.c
 LOCAL_MODULE := utility_make_ext4fs
 LOCAL_MODULE_STEM := make_ext4fs
 LOCAL_MODULE_TAGS := optional
-- 
2.7.4


From 3a498c7c4d14127e2cc5e93986d676871c13cb7b Mon Sep 17 00:00:00 2001
From: sooti <sooti85@gmail.com>
Date: Sat, 26 Dec 2015 21:55:41 +0200
Subject: [PATCH 4/4] fix ext4 error

Change-Id: I581d4a370b93bec1bef8d512ffe1b79942cd5610
---
 ext4_utils/Android.mk | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ext4_utils/Android.mk b/ext4_utils/Android.mk
index 0263f99..f0c20eb 100644
--- a/ext4_utils/Android.mk
+++ b/ext4_utils/Android.mk
@@ -1,4 +1,4 @@
-\# Copyright 2010 The Android Open Source Project
+# Copyright 2010 The Android Open Source Project
 
 LOCAL_PATH:= $(call my-dir)
 
-- 
2.7.4

